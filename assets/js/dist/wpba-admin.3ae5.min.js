jQuery(function($){var media={uploader:{fileFrame:void 0}};media.uploader._open=function(elem,callback){if(media.uploader.fileFrame)return void media.uploader.fileFrame.open();var titleText=elem.attr("title"),title="undefined"==typeof titleText?"Add Attachment(s)":titleText,buttonLinkText=elem.find(".wpba-add-link-title").text(),buttonText="undefined"==typeof buttonLinkText?title:buttonLinkText;media.uploader.fileFrame=wp.media({title:title,button:{text:buttonText},multiple:!0}),media.uploader.fileFrame.on("select",function(){var attachments=media.uploader.fileFrame.state().get("selection").toJSON();"undefined"!=typeof callback&&callback(attachments)}),media.uploader.fileFrame.open()},media.uploader._addAttachmentHandler=function(elem,callback){elem="undefined"==typeof activatorElem?$(".wpba-add-link"):elem,elem.on("click",function(e){return e.preventDefault(),media.uploader._open($(this),callback),!1})},media.uploader.init=function(activatorElem,callback){return media.uploader._addAttachmentHandler(activatorElem,callback),!1},WPBA_ADMIN_JS.media=media}(jQuery)),jQuery(function($){var meta={wyswig:{},attachment:{}};meta.wyswig.initNew=function(){var wyswigAJAX=$(".wpba-wyswig-input-wrap.ajax"),wyswigElem=wyswigAJAX.find("textarea");0!==wyswigElem.length&&wyswigElem.each(function(index,el){var that=$(el),id=that.attr("id"),editorSelector="#"+id;tinymce.init({selector:editorSelector,menubar:!1})})},meta.wyswig.init=function(){var wyswigSelector=".wpba-wyswig";meta.wyswigEditors=$(wyswigSelector)},meta.attachment.addIDs=function(ids){ids=ids.replace(/,\s*$/,"");var currentIDs=meta.sortableElem.data("attachmentids"),newIDs=""===currentIDs||"undefined"==typeof currentIDs?ids:currentIDs+","+ids;return meta.sortableElem.data("attachmentids",newIDs),!1},meta.attachment.removeIDs=function(id){var currentIDs=meta.sortableElem.data("attachmentids").toString().split(",");return $.each(currentIDs,function(index,val){val===id&&currentIDs.splice(index,1)}),meta.sortableElem.data("attachmentids",currentIDs.join()),!1},meta.attachment.initSorting=function(){meta.sortableElem=$("#wpba_sortable"),meta.sortableElem.sortable({placeholder:"ui-state-highlight",items:".wpba-sortable-item",handle:".wpba-sort-handle",cursor:"move",start:function(event,ui){$(".ui-state-highlight").css({height:ui.item.outerHeight(),width:ui.item.outerWidth()}),meta.sortableElem.find(meta.wyswigEditors).each(function(index,el){tinymce.execCommand("mceRemoveEditor",!1,$(el).attr("id")),tinymce.execCommand("mceRemoveControl",!1,$(el).attr("id"))})},stop:function(){meta.sortableElem.find(meta.wyswigEditors).each(function(index,el){tinymce.execCommand("mceAddEditor",!0,$(el).attr("id")),tinymce.execCommand("mceAddControl",!0,$(el).attr("id")),meta.sortableElem.sortable("refresh")})},update:function(){meta.sortableElem.find(".wpba-sortable-item").each(function(index,el){$(el).find(".menu-order-input").val(index+1)})}})},meta.attachment.remove=function(elem){return 0===meta.sortableElem.length||"undefined"==typeof meta.sortableElem?!1:(elem.hasClass("attachment-item")?elem.remove():elem.parentsUntil(".attachment-item").remove(),meta.sortableElem.sortable("refresh"),!1)},meta.getCurrentPostID=function(){var postID=meta.sortableElem.data("postid");return"undefined"!=typeof postID?postID:!1},meta.attachment.add=function(attachmentIDs,callback){var currentAttachments=meta.sortableElem.data("attachmentids"),ajaxData={postid:meta.getCurrentPostID(),attachmentids:attachmentIDs,currentattachments:currentAttachments.toString().split(","),action:"wpba_add_attachments"};return $.post(ajaxurl,ajaxData,function(data,textStatus){data=$.parseJSON(data);var success="success"===textStatus&&data.success===!0?!0:!1,sortableElemExists=0!==meta.sortableElem.length&&"undefined"!=typeof meta.sortableElem;if(success&&sortableElemExists&&""!==data.html){meta.sortableElem.prepend(data.html).sortable("refresh"),meta.resetEventHandlers(),meta.wyswig.initNew();var newIDs=0===attachmentIDs.length?"":attachmentIDs.join();meta.attachment.addIDs(newIDs)}"undefined"!=typeof callback&&callback(success)}),!1},meta.attachment.addHandler=function(){return WPBA_ADMIN_JS.media.uploader.init($(".wpba-add-link"),function(attachments){var attachmentIDs=[];$.each(attachments,function(index,val){attachmentIDs.push(val.id)}),meta.attachment.add(attachmentIDs)}),!1},meta.attachment.delete=function(id,callback){var ajaxParams={action:"wpba_delete_attachment",id:id};return $.post(ajaxurl,ajaxParams,function(data,textStatus){var success="success"===textStatus&&$.parseJSON(data)===!0?!0:!1;success&&(meta.attachment.remove($("#wpba_attachment_"+id)),meta.attachment.removeIDs(id)),"undefined"!=typeof callback&&callback(success)}),!1},meta.attachment.deleteHandler=function(elem){return elem="undefined"==typeof elem?$(".wpba-delete-link").not(".wpba-has-delete-handler"):elem.not(".wpba-has-delete-handler"),elem.on("click",function(e){e.preventDefault();var makeSure=confirm("Are you sure you want to permanently delete this attachment?");if(!makeSure)return!1;var attachmentId=$(this).attr("id").replace("wpba_delete_","");return meta.attachment.delete(attachmentId),!1}),elem.addClass("wpba-has-delete-handler"),!1},meta.attachment.unattach=function(id,callback){var ajaxParams={action:"wpba_unattach_attachment",id:id};return $.post(ajaxurl,ajaxParams,function(data,textStatus){var success="success"===textStatus&&$.parseJSON(data)===!0?!0:!1;success&&(meta.attachment.remove($("#wpba_attachment_"+id)),meta.attachment.removeIDs(id)),"undefined"!=typeof callback&&callback(success)}),!1},meta.attachment.unattachHandler=function(elem){return elem="undefined"==typeof elem?$(".wpba-unattach-link").not(".wpba-has-unattach-handler"):elem.not(".wpba-has-unattach-handler"),elem.on("click",function(e){e.preventDefault();var attachmentId=$(this).attr("id").replace("wpba_unattach_","");return meta.attachment.unattach(attachmentId),!1}),elem.addClass("wpba-has-unattach-handler"),!1},meta.resetEventHandlers=function(elem){return meta.attachment.unattachHandler(elem),meta.attachment.deleteHandler(elem),meta.sortableElem.sortable("refresh"),!1},meta.init=function(){meta.wyswig.init(),meta.attachment.initSorting(),meta.attachment.addHandler(),meta.resetEventHandlers()},$(document).ready(function(){meta.init()}),WPBA_ADMIN_JS.meta=meta}(jQuery)),function(){for(var method,noop=function(){},methods=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],length=methods.length,console=window.console=window.console||{};length--;)method=methods[length],console[method]||(console[method]=noop)}();
//# sourceMappingURL=wpba-admin.min.map